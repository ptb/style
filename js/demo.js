import{isFn,isStr,get,isObj,toPairs,isArr,canUseDom,css,debounce,store,getStyles,sortJSON}from"../index.js";import cssbeautify from"./cssbeautify.js";import{useRef,useState,useEffect,jsxs,jsx,forwardRef,useMemo,useCallback,Fragment,Children,cloneElement,StrictMode}from"./react.js";import{Prism}from"./prism.js";import{renderToStaticMarkup}from"./react-dom-server.js";import{hydrate}from"./react-dom.js";var classNames$2={":root":"ae22hd aeyhgy af2lud af6z1x af7u8f afad0u affi1y afpkmk afyqpc c72klf c7c2s1 e5p9ey k0rwal kcv30j",grid:"orthw2",radio:"duh7by",sublist:"or49rs",tab:"or77o3 ord5mr orjuoq ord5mr orfyby ormcn8 orztaz",tablist:"or5tff orbdsq orctbj oriq7b orshze orud0z",tabpanel:"orctww ori8ey ornd3m ornomo orp1wz"},classNames$1={$editor:"",code:"orv59l",div:"or1cqo",pre:"orqipf",textarea:"or2bxt ornyem"};function Editor({children:e="",id:t,lang:n="js",onInput:r,readOnly:s=!1,rows:a=3,...i}){const o=useRef(null),l=useRef(null),c=useRef(null),[u,d]=useState(e);return useEffect((function(){e!==u&&d(e)}),[e,u]),useEffect((function(){Prism.highlightElement(o.current)}),[u]),useEffect((function(){c&&c.current&&new ResizeObserver((function(e){for(const t of e)Prism.plugins.lineNumbers.resize(t.target),Prism.plugins.lineHighlight.highlightLines(t.target)()})).observe(c.current)}),[c]),jsxs("div",{className:classNames$1.div,children:[jsx("pre",{"aria-hidden":!0,className:[classNames$1.pre,`language-${n}`,"line-numbers"].join(" "),id:t,ref:c,...i,children:jsx("code",{className:classNames$1.code,ref:o,children:u+("\n"===u[u.length-1]?" ":"")})}),jsx("textarea",{className:classNames$1.textarea,onInput:function(e){d(e.target.value||""),isFn(r)&&r(e)},onScroll:function(){c.current&&l.current&&(c.current.scrollTop=l.current.scrollTop,c.current.scrollLeft=l.current.scrollLeft)},readOnly:s,ref:l,rows:a,spellCheck:!1,value:u})]})}function getId(e){return(isStr(e)?e:"").trim().toLowerCase().replace(/[^0-9a-z]/gu,"-")}var classNames={editor:"kd430i",html:"kdel1p",internal:"kdwcsj",item:"or6eiw",minified:"kdbcwx",preview:"kdsaqd",styles:"kdrt8e"};function TabItem({children:e}){return jsx("div",{className:[classNames.item,get(classNames,getId(e))].join(" "),children:e})}const Tab=forwardRef((function({as:e="li",classNames:t={},handleClick:n,index:r,label:s,menuitem:a,onKeyDown:i,selected:o,...l},c){const u=getId(s);return jsx(e,{role:"none",children:jsx("label",{"aria-controls":`${u}-panel`,"aria-selected":String(r)===o,className:t.tab,htmlFor:`${u}-input`,id:`${u}-tab`,onClick:function(){n(r)},onKeyDown:i,ref:c,role:"tab",tabIndex:String(r)===o?0:-1,...l,children:isFn(a)?jsx(a,{index:r,children:s}):s})})}));function Tablist({as:e="ul",classNames:t={},group:n,heading:r,initial:s,menuitem:a,orientation:i="horizontal",selected:o,setSelected:l,tabs:c,total:u,updParams:d,...m}){const[f,h]=useState(Number(s)),p=useMemo((function(){return Array.from(Array(u).keys()).map((function(){return{current:null}}))}),[u]),w=useCallback((function(e){h(e),l(String(e)),d(String(e))}),[h,l,d]),b=useCallback((function(e){let t=f;switch(e.code){case"ArrowDown":"vertical"===i&&(e.preventDefault(),t=(f+1+u)%u);break;case"ArrowLeft":"horizontal"===i&&(e.preventDefault(),t=(f-1+u)%u);break;case"ArrowRight":"horizontal"===i&&(e.preventDefault(),t=(f+1+u)%u);break;case"ArrowUp":"vertical"===i&&(e.preventDefault(),t=(f-1+u)%u);break;case"End":e.preventDefault(),t=u-1;break;case"Home":e.preventDefault(),t=0;break;case"Enter":case"Space":e.preventDefault(),l(String(t)),d(String(t))}h(t);const n=p[t];n&&n.current&&n.current.focus()}),[f,i,p,h,l,u,d]);let g=0;function x(e){const n=g++;return jsx(Tab,{classNames:t,handleClick:w,index:n,label:e,menuitem:a,onKeyDown:b,ref:p[n],selected:o},getId(e))}return jsxs(e,{"aria-label":n,"aria-orientation":i,className:t.tablist,role:"tablist",...m,children:[isObj(c)&&toPairs(c).map((function([n,s]){return jsxs("li",{children:[isFn(r)&&jsx(r,{children:n}),jsx(e,{className:t.sublist,children:s.map(x)})]})})),isArr(c)&&c.map(x)]})}function Tabpanel({as:e="section",children:t,classNames:n={},group:r,index:s,label:a,selected:i,...o}){const l=getId(a),c=getId(r);return jsxs(Fragment,{children:[jsx("input",{checked:s===i,className:n.radio,id:`${l}-input`,name:c,type:"radio"}),jsx(e,{"aria-hidden":s!==i,"aria-labelledby":`${l}-tab`,className:n.tabpanel,id:`${l}-panel`,role:"tabpanel",tabIndex:s===i?0:-1,...o,children:t})]})}function Tabpanels({children:e,classNames:t,group:n,labels:r,selected:s}){return jsx(Fragment,{children:Children.map(e,(function(e,a){return cloneElement(e,{classNames:t,group:n,index:String(a),label:r[a],selected:s})}))})}function useParam(e,t){const n=useCallback((function(){if(canUseDom()&&window.location){if(t){const e={};for(const[t,n]of new URLSearchParams(window.location.search))e[t]=n;return e}return new URL(window.location.href).hash.slice(1).split("&").reduce((function(e,t){if(t){const[n,r]=t.split("=");isStr(n)&&(e[n]=isStr(r)?r:"")}return e}),{})}return{}}),[t]),r=useCallback((function(){return get(n(),e,"")}),[n,e]),[s,a]=useState(r());const i=useCallback((function(){a(r())}),[r]);return useEffect((function(){if(!t)return window.addEventListener("hashchange",i),function(){window.removeEventListener("hashchange",i)}}),[t,i]),[s,function(r){const s=toPairs({...n(),[e]:r}).reduce((function(e,[t,n]){return e.concat([t,n].join("="))}),[]).join("&");if(t){const t=new URL(window.location.href);t.searchParams.set(e,r),window.history.replaceState(null,"",t),a(r)}else window.history.pushState(null,"",`#${s}`)}]}function useTabs({group:e="t",tabs:t=[]}){const[n,r]=useParam(e),[s,a]=useState(n||"0");return{labels:useMemo((function(){return isArr(t)?t:isObj(t)?Object.values(t).reduce((function(e,t){return e.concat(t)}),[]):[]}),[t]),param:n,selected:s,setParam:r,setSelected:a}}function useVisualViewport({height:e,width:t}={height:"--viewport-height",width:"--viewport-width"}){const n=useCallback((function(){if("undefined"!=typeof window&&"undefined"!=typeof document&&void 0!==document.documentElement){const n=document.documentElement.style;void 0===window.visualViewport?(n.setProperty(e,`${window.innerHeight}px`),n.setProperty(t,`${window.innerWidth}px`)):(n.setProperty(e,`${window.visualViewport.height}px`),n.setProperty(t,`${window.visualViewport.width}px`))}}),[e,t]);return useEffect((function(){if("undefined"!=typeof window)return n(),void 0===window.visualViewport?(window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}):(window.visualViewport.addEventListener("resize",n),function(){window.visualViewport.removeEventListener("resize",n)})}),[n]),{height:e,width:t}}function Demo({children:children}){window.createElement=jsx,window.css=css,window.Fragment=Fragment;const params={};if(canUseDom()&&window.location)for(const[e,t]of new URLSearchParams(window.location.search))params[e]=t;const setSearch=useParam("x",!0)[1],[value,setValue]=useState(children),[source,setSource]=useState(handleSource(children));function handleSource(input){try{return renderToStaticMarkup(eval(input))}catch(e){return source}}useEffect((function(){children!==value&&(setValue(children),setSource(handleSource(children)))}),[children]);const[inside,setInside]=useState(""),[minify,setMinify]=useState(""),[styles,setStyles]=useState(""),handleUpdate=debounce((function(){store.clear(),setSource(handleSource(value));const e=getStyles();setMinify(e),setStyles(cssbeautify(e)),setInside(JSON.stringify(sortJSON([...store.values()].reduce((function(e,t){return e.concat([...t.values()])}),[])),null,2)),setSearch(value)}),350);function onInput(e){setValue(e.target.value||"")}useEffect((function(){handleUpdate()}),[handleUpdate,value]);const tabs={Input:["Editor"],Output:["Preview","HTML","Styles","Minified","Internal"]},{labels:labels,param:param,selected:selected,setParam:setParam,setSelected:setSelected}=useTabs({group:"t",tabs:tabs});return useVisualViewport(),jsxs("div",{className:classNames$2.grid,children:[jsx(Tablist,{classNames:classNames$2,group:"t",initial:param,menuitem:TabItem,orientation:"horizontal",selected:selected,setSelected:setSelected,tabs:tabs,total:labels.length,updParams:setParam}),jsxs(Tabpanels,{classNames:classNames$2,group:"t",labels:labels,selected:selected,children:[jsx(Tabpanel,{children:jsx(Editor,{"data-line":params.e,id:"editor",onInput:onInput,children:value})}),jsx(Tabpanel,{children:jsx("div",{dangerouslySetInnerHTML:{__html:source}})}),jsx(Tabpanel,{children:jsx(Editor,{"data-line":params.h,id:"html",lang:"html",readOnly:!0,children:source})}),jsx(Tabpanel,{children:jsx(Editor,{"data-line":params.s,id:"styles",lang:"css",readOnly:!0,children:styles})}),jsx(Tabpanel,{children:jsx(Editor,{"data-line":params.m,id:"minify",lang:"css",readOnly:!0,children:minify})}),jsx(Tabpanel,{children:jsx(Editor,{"data-line":params.i,id:"internal",lang:"js",readOnly:!0,children:inside})})]})]})}let content=['createElement(\n  "span",\n  {\n    className: css({\n      ','\n    })\n  },\n  "Buy Now!"\n)'].join("");if(canUseDom()&&window.location.search){const e=new URLSearchParams(window.location.search),t=e.get("x");if(e.has("x")&&isStr(t))try{content=t}catch(e){console.error(e)}}hydrate(jsx(StrictMode,{children:jsx(Demo,{children:content})}),document.getElementById("root"));export{Demo};
